name: OSS Upload

on:
  # schedule:
  #   - cron: '*/5 * * * *' # every 5 minutes
  # workflow_dispatch: # on button click
  push:
    branches:
      - main

jobs:
  grafana-mirror:
    uses: ./.github/workflows/index-mirror.yml
    with:
      source-url: 'https://grafana.github.io/helm-charts/index.yaml'
      dest-namespace: grafana
      # oss-key-id: ${{ secrets.OSS_KEY_ID }}
      # oss-key-secret: ${{ secrets.OSS_KEY_SECRET }}
    secrets: inherit
  prometheus-mirror:
    uses: ./.github/workflows/index-mirror.yml
    with:
      source-url: 'https://prometheus-community.github.io/helm-charts/index.yaml'
      dest-namespace: prometheus-community
    secrets: inherit
